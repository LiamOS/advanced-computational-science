\documentclass[10pt]{article}
\usepackage{/home/liam/4thlabs/latex/lab}


\title{Assignment 1 - Advanced Computational Science}

\newcommand{\ujn}{u_{j}^{n}}
\newcommand{\ujpn}{u_{j+1}^{n}}
\newcommand{\ujmn}{u_{j-1}^{n}}
\newcommand{\ujnp}{u_{j}^{n+1}}
\newcommand{\ujnm}{u_{j}^{n-1}}
\newcommand{\eihjk}{e^{ikhj}}
\newcommand{\eihjpk}{e^{ikh(j+1)}}
\newcommand{\eihjmk}{e^{ikh(j-1)}}

\begin{document}
\maketitle

\section*{Question 1}
\subsection*{(1)}
We are interested in solving the 1-d wave equation with $c=1$,
\begin{equation}
\frac{\partial^2 u}{\partial t^2} = \frac{\partial^2 u}{\partial x^2}
\label{e:we}
\end{equation}
using central differences,
$$
\frac{\partial^2 u}{\partial t^2} \approx \frac{\delta_t^2 \ujn}{\tau^2},
\hspace{5mm}
\frac{\partial^2 u}{\partial x^2} \approx \frac{\delta_x^2 \ujn}{h^2}
$$
so our equation becomes
\begin{equation}
\frac{\delta_t^2 \ujn}{\tau^2} = \frac{\delta_x^2 \ujn}{h^2}
\label{e:wecd}
\end{equation}
where $\tau$ is the time step size, and $h$ is the $x$ step size.

The operator $\delta_x ^2$, when applied to $\ujn$, gives
$$
\delta_x^2 = \ujnm - 2\ujn + \ujnp
$$
allowing us to expand out for both spatial and temporal derivatives and rearrange
for $\ujnp$, giving
\begin{equation}
\ujnp = \nu^2 \left[\ujmn + \ujpn \right] - \ujnm + 2(1 - \nu^2)\ujn
\label{e:cd}
\end{equation}
with $\nu = \frac{\tau}{h}$.

A program was written in Python 3.3 to solve this problem with Dirichlet boundary
conditions, $u(-7,t) = u(7,t) = 0$, on the intervals $x \in \left[-7,7\right]$,
$t \in \left[0,14\right] $. The initial condition is given by
$u(x,0) = e^{-x^2}$.
The program is included in appendix \ref{a:1.1}.

The solutions at various times are shown in figure \ref{f:dirichlet}.
\begin{figure}
  \centering
  \includegraphics[width=\textwidth]{1/dirichlet.pdf}
  \caption{Solution to the wave equation with Gaussian initial condition.}
  \label{f:dirichlet}
\end{figure}

\subsection*{(2)}
Our expression for $\ujn$ using Central Differences is given in equation \ref{e:cd}.
To perform Fourier/von Neumann stability analysis, we take $\ujn = \xi^n \eihjk$ as
a single Fourier mode solution, and see how our {\it amplification factor}, $\xi$,
behaves as a function of $\tau,h,k$.
Substituting this into equation \ref{e:cd} gives
$$
\xi^{n+1} \eihjk= \nu^2 \left[ \xi^n \eihjmk + \xi^n \eihjpk \right] - \xi^{n-1} \eihjk +
2(1 - \nu^2) \xi^n \eihjk.
$$
Dividing across by $\xi^{n-1} \eihjk$ and cleaning up gives
$$
\xi^2 + \alpha \xi + 1 = 0
$$
with
$$
\alpha = -\nu^2 \left[ e^{-ikh} + e^{ikh} - 2\left(1 - \frac{1}{\nu^2}\right) \right]
= -2 \nu^2 \left[ \cos(kh) - \left(1 - \frac{1}{\nu^2}\right) \right].
$$
This is a quadratic equation with roots
$$
\xi_\pm = \frac{1}{2} \left( -\alpha \pm \sqrt{\alpha^2 - 4} \right) =
\frac{1}{2} \left( -\alpha \pm i\sqrt{(2 - \alpha)(2+\alpha)}\right)
$$
Our stability condition is $|\xi| \le 1$, with this implying
$$
$$

\subsection*{(3)}
The program used is included in appendix \ref{a:1.3}.


\section*{}


\begin{appendix}
\section{Program for 1.1}
\label{a:1.1}
\lstinputlisting[language=python]{1/dirichlet.py}
\newpage
\section{Program for 1.3}
\label{a:1.3}
\lstinputlisting[language=python]{1/hstudy.py}
\end{appendix}



\end{document}
